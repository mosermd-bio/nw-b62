<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Needleman-Wunsch BLOSUM62 Aligner</title>
    <link rel="stylesheet" href="https://mosermd-bio.github.io/z-core/core.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="page">
        <div class="alert mb-lg">
            <p>VectorBuilder-style alignment + expandable grouped variant blocks with per-substitution classification.</p>
        </div>

        <div class="flex-between mb-lg">
            <div>
                <h1>Needleman-Wunsch BLOSUM62 Aligner</h1>
                <p class="subtitle">Global pairwise amino-acid alignment</p>
            </div>
        </div>

        <div class="prose mb-xl">
            <p>Click any quick example or the demo button below to load real SARS-CoV-2 spike variant data and see the alignment instantly.</p>
        </div>

        <div class="panel">
            <div class="grid-2">
                <div>
                    <label>Sequence 1 (Query)</label>
                    <textarea id="seq1" rows="6" class="mono" placeholder="MFVFLVLLPL..."></textarea>
                </div>
                <div>
                    <label>Sequence 2 (Subject)</label>
                    <textarea id="seq2" rows="6" class="mono" placeholder="MFVFLVLLPL..."></textarea>
                </div>
            </div>

            <div class="flex-row items-end mt-lg gap-lg">
                <div>
                    <label>Gap Penalty</label>
                    <div class="flex-row gap-sm">
                        <input type="number" id="gapPenalty" value="-4" step="1" class="mono text-center" style="width:7rem">
                        <button id="resetConfig" class="btn btn-link text-sm">Reset to â€“4</button>
                    </div>
                </div>
                <div class="flex-row gap-sm">
                    <button id="alignBtn" class="btn btn-success btn-lg">Align Sequences</button>
                    <button id="clearBtn" class="btn btn-muted btn-lg">Clear</button>
                </div>
            </div>

            <div class="mt-lg">
                <p class="text-xs text-dim font-medium mb-sm">QUICK EXAMPLES</p>
                <div class="flex-row flex-wrap gap-sm" id="exampleBtns"></div>
                <button id="demoBtn" class="btn btn-violet btn-lg mt-md">
                    ðŸ“Š Load SARS-CoV-2 Spike Variant Example
                </button>
            </div>
        </div>

        <div id="results" class="hidden panel">
            <div class="flex-between mb-lg">
                <h2>Alignment Result</h2>
                <button id="saveBtn" class="btn btn-success btn-sm">Save Comparison</button>
            </div>
            <div id="alignmentViz" class="alignment-viz mb-lg"></div>
            <div class="stat-grid">
                <div><div class="stat-value stat-green" id="score"></div><div class="stat-label">Score</div></div>
                <div><div class="stat-value stat-blue" id="identity"></div><div class="stat-label">% Identity</div></div>
                <div><div class="stat-value stat-amber" id="similarity"></div><div class="stat-label">% Similarity</div></div>
                <div><div class="stat-value stat-purple" id="gaps"></div><div class="stat-label">Gaps</div></div>
            </div>
            <div id="warning" class="hidden mt-md text-sm" style="color:var(--warning-border)"></div>
            <h3 class="mt-xl mb-md">Grouped Continuous Variant Blocks (click row to expand)</h3>
            <div class="overflow-x">
                <table id="variantTable" class="w-full text-sm"></table>
            </div>
        </div>

        <div class="panel">
            <h2 class="flex-row mb-lg">Saved Comparisons <span id="count" class="text-sm text-dim font-medium">(0)</span></h2>
            <div id="history"></div>
        </div>

        <details class="references">
            <summary>References</summary>
            <ol>
                <li>
                    Needleman SB, Wunsch CD. A general method applicable to the search for similarities in the amino acid sequence of two proteins. <em>J Mol Biol.</em> 1970;48(3):443-453. doi:10.1016/0022-2836(70)90057-4
                </li>
                <li>
                    Henikoff S, Henikoff JG. Amino acid substitution matrices from protein blocks. <em>Proc Natl Acad Sci USA.</em> 1992;89(22):10915-10919. doi:10.1073/pnas.89.22.10915
                </li>
            </ol>
        </details>

        <div class="footer">
            100% client-side â€¢ Data never transmitted
        </div>
    </div>

    <script src="scripts.js"></script>
</body>
</html>
